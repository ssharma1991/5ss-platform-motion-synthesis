(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67817,       1660]
NotebookOptionsPosition[     62772,       1568]
NotebookOutlinePosition[     63115,       1583]
CellTagsIndexPosition[     63072,       1580]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]}], "Input",
 CellLabel->
  "In[2306]:=",ExpressionUUID->"17c693b0-862d-4520-bc11-871be0d058cd"],

Cell[CellGroupData[{

Cell["Generate planar quaternions", "Subchapter",
 CellChangeTimes->{{3.790290137490938*^9, 
  3.790290151435461*^9}},ExpressionUUID->"f7a06c17-5781-4435-99e6-\
8dd526588c03"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "x"}], ",", "y", ",", "\[Phi]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nPoses", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pose", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".8253"}], ",", " ", 
         RowBox[{"-", "1.6554"}], ",", 
         RowBox[{"-", "2.6392"}], ",", 
         RowBox[{"-", "3.5027"}], ",", 
         RowBox[{"-", "4.0549"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.0329"}], ",", 
         RowBox[{"-", "0.2721"}], ",", "0.2920", ",", "0.3088", ",", 
         RowBox[{"-", "0.2141"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "91.91", ",", "66.99", ",", "49.90", ",", "43.94", ",", "45.58"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pose", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8252945830827176`"}], ",", 
         RowBox[{"-", "1.6553786754079571`"}], ",", 
         RowBox[{"-", "2.6391727842743435`"}], ",", 
         RowBox[{"-", "3.5027614663949085`"}], ",", 
         RowBox[{"-", "4.054902440181838`"}], ",", 
         RowBox[{"-", "4.102238432512293`"}], ",", 
         RowBox[{"-", "3.5805567359474804`"}], ",", 
         RowBox[{"-", "2.6250006556950063`"}], ",", 
         RowBox[{"-", "1.55571408595687`"}], ",", 
         RowBox[{"-", "0.8015299266008866`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.0328994884119975`"}], ",", 
         RowBox[{"-", "0.2720480472747241`"}], ",", "0.29204936079463484`", 
         ",", "0.30883529454705205`", ",", 
         RowBox[{"-", "0.21405162594639093`"}], ",", 
         RowBox[{"-", "1.0520282273648571`"}], ",", 
         RowBox[{"-", "1.870754371634305`"}], ",", 
         RowBox[{"-", "2.3408231801766552`"}], ",", 
         RowBox[{"-", "2.274230255459204`"}], ",", 
         RowBox[{"-", "1.7382574576501564`"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "91.91008883877934`", ",", "66.99025874601674`", ",", 
         "49.896087252338035`", ",", "43.93479414700032`", ",", 
         "45.58123098259269`", ",", "52.86785609295374`", ",", 
         "64.51462242691119`", ",", "78.84042558226331`", ",", 
         "93.01589406773181`", ",", "101.25121979920672`"}], "}"}]}], "}"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pose", "=", 
     RowBox[{"Transpose", "[", "pose", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Generate", " ", "quaternion", " ", "q1"}], ",", "q2", ",", "q3",
      ",", "q4"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quat", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", 
      RowBox[{
       RowBox[{"Dimensions", "[", "pose", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d1", "=", 
       RowBox[{
        RowBox[{"pose", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"d2", "=", 
       RowBox[{
        RowBox[{"pose", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{
        RowBox[{"pose", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{".5", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "/", "2"}], " ", "Degree"}], "]"}]}], "-", 
          RowBox[{"d2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "/", "2"}], " ", "Degree"}], "]"}]}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q2", "=", 
       RowBox[{".5", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "/", "2"}], " ", "Degree"}], "]"}]}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "/", "2"}], " ", "Degree"}], "]"}]}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q3", "=", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "/", "2"}], " ", "Degree"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q4", "=", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "/", "2"}], " ", "Degree"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quat", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"quat", ",", 
         RowBox[{"{", 
          RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "}"}]}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{"quat", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.790290187795352*^9, 3.7902902374027443`*^9}, {
  3.7902903124435606`*^9, 3.790290587572955*^9}, {3.7902908682492485`*^9, 
  3.7902912282713976`*^9}, {3.7902914751385007`*^9, 3.7902914769153004`*^9}, {
  3.790301900540066*^9, 3.790301903758479*^9}, {3.790302133856371*^9, 
  3.7903021352646465`*^9}, {3.7903027314918575`*^9, 3.7903027518295164`*^9}, {
  3.790303019425408*^9, 3.790303019690809*^9}, {3.7903030528323817`*^9, 
  3.7903030643834825`*^9}, {3.790305434900055*^9, 3.7903054352171617`*^9}, {
  3.7903056089219065`*^9, 3.7903056204695063`*^9}, {3.7903056731743574`*^9, 
  3.790305674621326*^9}, {3.7909188487932653`*^9, 3.7909188493038673`*^9}, {
  3.790918880868766*^9, 3.790919012036858*^9}, {3.790947341686837*^9, 
  3.7909473803058515`*^9}, {3.790989236292926*^9, 3.7909892660347743`*^9}},
 CellLabel->
  "In[2308]:=",ExpressionUUID->"5e095b90-bb69-4c62-8c36-04829b885541"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.06243889924741486`", 
      RowBox[{"-", "0.6581029625884022`"}], "0.7187945341055915`", 
      "0.6952225670531169`"},
     {
      RowBox[{"-", "0.3433387969441673`"}], 
      RowBox[{"-", "0.765304282797555`"}], "0.5518660959536136`", 
      "0.833932738376973`"},
     {
      RowBox[{"-", "0.688995789859284`"}], 
      RowBox[{"-", "1.1348639809047238`"}], "0.42179623931828775`", 
      "0.9066906487313905`"},
     {
      RowBox[{"-", "0.7983610883521617`"}], 
      RowBox[{"-", "1.5664606139350887`"}], "0.37407893883931026`", 
      "0.9273968662427405`"},
     {
      RowBox[{"-", "0.6866928630949931`"}], 
      RowBox[{"-", "1.910619241571991`"}], "0.3873645887585825`", 
      "0.9219266106235866`"},
     {
      RowBox[{"-", "0.442069067371475`"}], 
      RowBox[{"-", "2.0708345725242405`"}], "0.4451655023989152`", 
      "0.8954483097722176`"},
     {
      RowBox[{"-", "0.16450090982001597`"}], 
      RowBox[{"-", "2.013198093891985`"}], "0.5337224304557213`", 
      "0.845659723073316`"},
     {"0.07071244688192979`", 
      RowBox[{"-", "1.7571340730487417`"}], "0.6350030784610952`", 
      "0.7725096053415338`"},
     {"0.21831216305121404`", 
      RowBox[{"-", "1.3603059187133475`"}], "0.7254698401266794`", 
      "0.6882539582643679`"},
     {"0.24156406467082253`", 
      RowBox[{"-", "0.9260907653885835`"}], "0.7730172062807771`", 
      "0.6343850556198991`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7902912108825836`*^9, 3.7902912287790146`*^9}, 
   3.790301672672056*^9, 3.790301907775878*^9, 3.790302494705641*^9, 
   3.7903027649335213`*^9, {3.7903030651285377`*^9, 3.7903030944999137`*^9}, 
   3.7903049159767523`*^9, 3.790305187333387*^9, 3.7903054382299013`*^9, 
   3.790305622818343*^9, 3.790305688334693*^9, 3.790919014395143*^9, 
   3.7909473833674316`*^9, {3.7909892678947916`*^9, 3.790989274098158*^9}},
 CellLabel->
  "Out[2314]//MatrixForm=",ExpressionUUID->"13ea1aae-6fee-4e41-937c-\
70337437041a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Coefficient Matrix (K)", "Subchapter",
 CellChangeTimes->{{3.790291390396794*^9, 
  3.790291418712715*^9}},ExpressionUUID->"bdb9bd4a-c093-4476-b158-\
37adc136f97e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"K", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "nPoses", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", "nPoses"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q1", "=", 
     RowBox[{"quat", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
    RowBox[{"q2", "=", 
     RowBox[{"quat", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
    RowBox[{"q3", "=", 
     RowBox[{"quat", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";", 
    RowBox[{"q4", "=", 
     RowBox[{"quat", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"K0", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"K1", "=", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["q3", "2"]}], "+", 
        SuperscriptBox["q4", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"K2", "=", 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{"q3", " ", "q4"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"K3", "=", 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q1", " ", "q3"}], "-", 
        RowBox[{"q2", " ", "q4"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"K4", "=", 
     RowBox[{
      RowBox[{"-", "4"}], 
      RowBox[{"(", 
       RowBox[{"q3", " ", "q4"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"K5", "=", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["q3", "2"]}], "+", 
        SuperscriptBox["q4", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"K6", "=", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q2", " ", "q3"}], "+", 
        RowBox[{"q1", " ", "q4"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"K7", "=", 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q1", " ", "q3"}], "+", 
        RowBox[{"q2", " ", "q4"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"K8", "=", 
     RowBox[{"4", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"q2", " ", "q3"}], "-", 
        RowBox[{"q1", " ", "q4"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"K9", "=", 
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["q1", "2"], "+", 
        SuperscriptBox["q2", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"K", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "K0", ",", "K1", ",", "K2", ",", "K3", ",", "K4", ",", "K5", ",", "K6", 
       ",", "K7", ",", "K8", ",", "K9"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "K", "]"}]}], "Input",
 CellChangeTimes->{{3.7903016564956894`*^9, 3.790301783757161*^9}},
 CellLabel->
  "In[2315]:=",ExpressionUUID->"2d539f0e-749b-4232-8605-cb25bb7588d5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      RowBox[{"-", "0.06666232904029734`"}], "1.998888724738554`", 
      "2.0096350821223274`", 
      RowBox[{"-", "1.998888724738554`"}], 
      RowBox[{"-", "0.06666232904029734`"}], 
      RowBox[{"-", "1.7185275222739254`"}], 
      RowBox[{"-", "1.6505891661654353`"}], 
      RowBox[{"-", "2.065798976823995`"}], 
      RowBox[{"-", "1.7479925020274427`"}]},
     {"1", "0.7817752485476679`", "1.8408768184640252`", 
      "1.7949410191440094`", 
      RowBox[{"-", "1.8408768184640252`"}], "0.7817752485476679`", 
      RowBox[{"-", "2.8346677995630873`"}], 
      RowBox[{"-", "3.310757350815914`"}], 
      RowBox[{"-", "0.544096094549448`"}], 
      RowBox[{"-", "2.814288699021393`"}]},
     {"1", "1.2883517299877991`", "1.5297548234398366`", 
      "2.9534189039984526`", 
      RowBox[{"-", "1.5297548234398366`"}], "1.2883517299877991`", 
      RowBox[{"-", "4.413549595856418`"}], 
      RowBox[{"-", "5.278345568548687`"}], "0.5840987215892697`", 
      RowBox[{"-", "7.050525814394945`"}]},
     {"1", "1.4402597900674223`", "1.3876785424279445`", "4.616322382858829`", 
      RowBox[{"-", "1.3876785424279445`"}], "1.4402597900674223`", 
      RowBox[{"-", "5.305509982649404`"}], 
      RowBox[{"-", "7.005522932789816`"}], "0.6176705890941041`", 
      RowBox[{"-", "12.364717129618974`"}]},
     {"1", "1.399794701503577`", "1.4284868895591978`", "5.981800892233711`", 
      RowBox[{"-", "1.4284868895591978`"}], "1.399794701503577`", 
      RowBox[{"-", "5.492746642393371`"}], 
      RowBox[{"-", "8.109804880363676`"}], 
      RowBox[{"-", "0.42810325189278187`"}], 
      RowBox[{"-", "16.488051897962915`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.790301784843774*^9, 3.7903019107047286`*^9, 3.7903024977505074`*^9, 
   3.7903027649774485`*^9, 3.7903030945487876`*^9, 3.790304916026428*^9, 
   3.7903051873872805`*^9, 3.7903054382797675`*^9, 3.790305622930047*^9, 
   3.790305688407499*^9, 3.7909190174563665`*^9, 3.790947383413621*^9, {
   3.7909892708618174`*^9, 3.790989274138052*^9}},
 CellLabel->
  "Out[2317]//MatrixForm=",ExpressionUUID->"6ff1b49a-116e-4152-b16e-\
3460ae436339"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find the solution space satisfying pose constraints", "Subchapter",
 CellChangeTimes->{{3.79030193590014*^9, 
  3.790301942682016*^9}},ExpressionUUID->"65adfd92-183e-471f-b240-\
e82d34234495"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "w", ",", "v"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "K", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nullSp", "=", 
   RowBox[{"v", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"6", ";;"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Diagonal", "[", "w", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "nullSp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K", ".", "nullSp"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7903019594337606`*^9, 3.79030197683499*^9}, 
   3.790302007575849*^9, {3.7903021207360773`*^9, 3.7903021211143904`*^9}, {
   3.7903053079410715`*^9, 3.790305357498093*^9}},
 CellLabel->
  "In[2318]:=",ExpressionUUID->"2cea9c1c-8145-4d81-a8c9-015763365fc8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "28.727149782490205`", ",", "4.676472059463202`", ",", "2.627089989658792`",
    ",", "0.35672926060609766`", ",", "0.07016573198427395`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.790301954225895*^9, 3.7903019772728586`*^9}, 
   3.7903020093700914`*^9, 3.7903021219382205`*^9, 3.790302500794914*^9, 
   3.790302765022319*^9, 3.790303094599648*^9, 3.7903049160772924`*^9, 
   3.790305187440102*^9, {3.7903053196747665`*^9, 3.7903053595299883`*^9}, 
   3.79030543832664*^9, 3.790305641599105*^9, 3.790305688474375*^9, 
   3.790919019253874*^9, 3.790947383451475*^9, 3.790989274173955*^9},
 CellLabel->
  "Out[2320]=",ExpressionUUID->"6f07aa06-25c0-4326-8a28-d5395d8147d4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.026823422060232138`"}], "0.17632173656059905`", 
      "0.38190431394984103`", "0.6568808081202699`", "0.556215552406938`"},
     {
      RowBox[{"-", "0.34415666029770453`"}], "0.3953233356051268`", 
      "0.5554315462231991`", 
      RowBox[{"-", "0.45986489574851025`"}], "0.07942646688152602`"},
     {
      RowBox[{"-", "0.09926763693687551`"}], "0.14087079423161597`", 
      "0.18026910126395773`", "0.19802113359280368`", 
      RowBox[{"-", "0.7039072646057851`"}]},
     {"0.2267021918820433`", "0.6495185145165606`", 
      RowBox[{"-", "0.2397795130557384`"}], 
      RowBox[{"-", "0.2850117309879134`"}], "0.1312672205845877`"},
     {
      RowBox[{"-", "0.15474158105620842`"}], "0.4832630762061243`", 
      RowBox[{"-", "0.08698566966519496`"}], "0.45976036208588894`", 
      RowBox[{"-", "0.3470722472205915`"}]},
     {"0.8656705415918681`", "0.0929875909280137`", "0.1701939570744988`", 
      "0.05198106935477708`", 
      RowBox[{"-", "0.10636090344532001`"}]},
     {"0.0641092988807729`", "0.27520273990409544`", 
      RowBox[{"-", "0.10048509803509877`"}], 
      RowBox[{"-", "0.018303724907700276`"}], "0.12756247910877358`"},
     {"0.20400700893138654`", 
      RowBox[{"-", "0.08903146486960448`"}], "0.593779402910132`", 
      RowBox[{"-", "0.13695893718167765`"}], 
      RowBox[{"-", "0.1351943460310355`"}]},
     {"0.02177499278096934`", "0.035227104230241314`", 
      RowBox[{"-", "0.003024610586926344`"}], 
      RowBox[{"-", "0.0353916072641354`"}], 
      RowBox[{"-", "0.006761987570700034`"}]},
     {"0.007435990861710922`", "0.2093256616476976`", 
      RowBox[{"-", "0.23757284446339347`"}], 
      RowBox[{"-", "0.04648505814326798`"}], "0.07233233669018857`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.790301954225895*^9, 3.7903019772728586`*^9}, 
   3.7903020093700914`*^9, 3.7903021219382205`*^9, 3.790302500794914*^9, 
   3.790302765022319*^9, 3.790303094599648*^9, 3.7903049160772924`*^9, 
   3.790305187440102*^9, {3.7903053196747665`*^9, 3.7903053595299883`*^9}, 
   3.79030543832664*^9, 3.790305641599105*^9, 3.790305688474375*^9, 
   3.790919019253874*^9, 3.790947383451475*^9, 3.790989274180937*^9},
 CellLabel->
  "Out[2321]//MatrixForm=",ExpressionUUID->"2eea2a75-442c-4543-b5f6-\
6f452cd5878f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "7.112366251504909`*^-17"}], 
      RowBox[{"-", "5.551115123125783`*^-17"}], 
      RowBox[{"-", "5.551115123125783`*^-16"}], 
      RowBox[{"-", "7.077671781985373`*^-16"}], 
      RowBox[{"-", "4.718447854656915`*^-16"}]},
     {
      RowBox[{"-", "2.42861286636753`*^-17"}], "3.3306690738754696`*^-16", 
      "4.440892098500626`*^-16", "1.1657341758564144`*^-15", 
      "8.326672684688674`*^-16"},
     {
      RowBox[{"-", "3.677613769070831`*^-16"}], "0.`", 
      RowBox[{"-", "2.220446049250313`*^-16"}], "8.881784197001252`*^-16", 
      RowBox[{"-", "4.440892098500626`*^-16"}]},
     {
      RowBox[{"-", "7.216449660063518`*^-16"}], "1.3322676295501878`*^-15", 
      "4.440892098500626`*^-16", "6.661338147750939`*^-16", 
      "1.3322676295501878`*^-15"},
     {
      RowBox[{"-", "7.494005416219807`*^-16"}], "1.3322676295501878`*^-15", 
      "8.881784197001252`*^-16", "0.`", 
      RowBox[{"-", "8.881784197001252`*^-16"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.790301954225895*^9, 3.7903019772728586`*^9}, 
   3.7903020093700914`*^9, 3.7903021219382205`*^9, 3.790302500794914*^9, 
   3.790302765022319*^9, 3.790303094599648*^9, 3.7903049160772924`*^9, 
   3.790305187440102*^9, {3.7903053196747665`*^9, 3.7903053595299883`*^9}, 
   3.79030543832664*^9, 3.790305641599105*^9, 3.790305688474375*^9, 
   3.790919019253874*^9, 3.790947383451475*^9, 3.790989274185924*^9},
 CellLabel->
  "Out[2322]//MatrixForm=",ExpressionUUID->"dd55bb68-6871-4a96-8a7c-\
a423485ae887"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Impose bilinear relationship between linear terms ", "Subchapter",
 CellChangeTimes->{{3.7903021604962177`*^9, 3.7903021671335144`*^9}, 
   3.7903022558959565`*^9},ExpressionUUID->"cecb9402-f3ee-4a61-a394-\
088a6ce62a8e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"W1", "=", 
   RowBox[{"nullSp", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W2", "=", 
   RowBox[{"nullSp", "[", 
    RowBox[{"[", 
     RowBox[{"5", ";;", "7"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W3", "=", 
   RowBox[{"nullSp", "[", 
    RowBox[{"[", 
     RowBox[{"8", ";;", "10"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mat1", "=", 
   RowBox[{"W1", "-", 
    RowBox[{"x", "*", "W3"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mat2", "=", 
   RowBox[{"W2", "-", 
    RowBox[{"y", "*", "W3"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mat4", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Mat1", ",", "Mat2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Mat4", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq1", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Mat4", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", 
      RowBox[{"Mat4", "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Mat4", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", 
      RowBox[{"Mat4", "[", 
       RowBox[{"[", "6", "]"}], "]"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790302351882373*^9, 3.7903023875701437`*^9}, {
   3.790302436205594*^9, 3.790302477176156*^9}, {3.7903025127237*^9, 
   3.7903025557572327`*^9}, 3.7903025963513994`*^9, {3.7903027222406726`*^9, 
   3.7903027238882694`*^9}, {3.7903028301384373`*^9, 3.790302853185964*^9}, {
   3.79030295105817*^9, 3.790302951902916*^9}},
 CellLabel->
  "In[2323]:=",ExpressionUUID->"b4053bd2-d9b7-483b-83a5-1a9a0965a6b8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.34415666029770453`"}], "-", 
       RowBox[{"0.20400700893138654`", " ", "x"}]}], 
      RowBox[{"0.3953233356051268`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.08903146486960448`", " ", "x"}]}], 
      RowBox[{"0.5554315462231991`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.593779402910132`", " ", "x"}]}], 
      RowBox[{
       RowBox[{"-", "0.45986489574851025`"}], "+", 
       RowBox[{"0.13695893718167765`", " ", "x"}]}], 
      RowBox[{"0.07942646688152602`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1351943460310355`", " ", "x"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.09926763693687551`"}], "-", 
       RowBox[{"0.02177499278096934`", " ", "x"}]}], 
      RowBox[{"0.14087079423161597`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.035227104230241314`", " ", "x"}]}], 
      RowBox[{"0.18026910126395773`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.003024610586926344`", " ", "x"}]}], 
      RowBox[{"0.19802113359280368`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0353916072641354`", " ", "x"}]}], 
      RowBox[{
       RowBox[{"-", "0.7039072646057851`"}], "+", 
       RowBox[{"0.006761987570700034`", " ", "x"}]}]},
     {
      RowBox[{"0.2267021918820433`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.007435990861710922`", " ", "x"}]}], 
      RowBox[{"0.6495185145165606`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2093256616476976`", " ", "x"}]}], 
      RowBox[{
       RowBox[{"-", "0.2397795130557384`"}], "+", 
       RowBox[{"0.23757284446339347`", " ", "x"}]}], 
      RowBox[{
       RowBox[{"-", "0.2850117309879134`"}], "+", 
       RowBox[{"0.04648505814326798`", " ", "x"}]}], 
      RowBox[{"0.1312672205845877`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.07233233669018857`", " ", "x"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.15474158105620842`"}], "-", 
       RowBox[{"0.20400700893138654`", " ", "y"}]}], 
      RowBox[{"0.4832630762061243`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.08903146486960448`", " ", "y"}]}], 
      RowBox[{
       RowBox[{"-", "0.08698566966519496`"}], "-", 
       RowBox[{"0.593779402910132`", " ", "y"}]}], 
      RowBox[{"0.45976036208588894`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13695893718167765`", " ", "y"}]}], 
      RowBox[{
       RowBox[{"-", "0.3470722472205915`"}], "+", 
       RowBox[{"0.1351943460310355`", " ", "y"}]}]},
     {
      RowBox[{"0.8656705415918681`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.02177499278096934`", " ", "y"}]}], 
      RowBox[{"0.0929875909280137`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.035227104230241314`", " ", "y"}]}], 
      RowBox[{"0.1701939570744988`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.003024610586926344`", " ", "y"}]}], 
      RowBox[{"0.05198106935477708`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0353916072641354`", " ", "y"}]}], 
      RowBox[{
       RowBox[{"-", "0.10636090344532001`"}], "+", 
       RowBox[{"0.006761987570700034`", " ", "y"}]}]},
     {
      RowBox[{"0.0641092988807729`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.007435990861710922`", " ", "y"}]}], 
      RowBox[{"0.27520273990409544`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2093256616476976`", " ", "y"}]}], 
      RowBox[{
       RowBox[{"-", "0.10048509803509877`"}], "+", 
       RowBox[{"0.23757284446339347`", " ", "y"}]}], 
      RowBox[{
       RowBox[{"-", "0.018303724907700276`"}], "+", 
       RowBox[{"0.04648505814326798`", " ", "y"}]}], 
      RowBox[{"0.12756247910877358`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.07233233669018857`", " ", "y"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7903024674929113`*^9, 3.790302523258523*^9, {3.7903025873742*^9, 
   3.790302597435508*^9}, 3.79030276508013*^9, {3.790302835357953*^9, 
   3.7903028558007936`*^9}, 3.790303094656497*^9, 3.7903049161396875`*^9, 
   3.790305187499943*^9, 3.7903054383934617`*^9, 3.7903056885561614`*^9, 
   3.7909190244646626`*^9, 3.790947383507462*^9, 3.790989274230857*^9},
 CellLabel->
  "Out[2329]//MatrixForm=",ExpressionUUID->"336d19a8-2bca-4282-a570-\
3005e51dc4f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{"eq1", ",", 
    RowBox[{"{", "y", "}"}], ",", "Simplify"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{"eq2", ",", 
    RowBox[{"{", "y", "}"}], ",", "Simplify"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"eq1Aprox", "=", 
  RowBox[{"Chop", "[", 
   RowBox[{"Expand", "[", "eq1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eq2Aprox", "=", 
  RowBox[{"Chop", "[", 
   RowBox[{"Expand", "[", "eq2", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7903025766358175`*^9, 3.7903025857954283`*^9}, {
  3.7903027174613757`*^9, 3.790302719118003*^9}, {3.790302809676733*^9, 
  3.790302810242196*^9}},
 CellLabel->
  "In[2332]:=",ExpressionUUID->"f28ad428-ca3e-4f4f-9ff1-92cd410055e9"],

Cell[BoxData[
 RowBox[{"0.17039191021610353`", "\[VeryThinSpace]", "-", 
  RowBox[{"0.18393960478610086`", " ", "x"}], "+", 
  RowBox[{"0.0379239368682324`", " ", 
   SuperscriptBox["x", "2"]}], "-", 
  RowBox[{"0.001236859621822365`", " ", 
   SuperscriptBox["x", "3"]}], "+", 
  RowBox[{"0.02440990886921375`", " ", "y"}], "-", 
  RowBox[{"0.005907197900875836`", " ", "x", " ", "y"}], "+", 
  RowBox[{"0.004641934176161802`", " ", 
   SuperscriptBox["y", "2"]}], "-", 
  RowBox[{"0.0012368596218226766`", " ", "x", " ", 
   SuperscriptBox["y", "2"]}]}]], "Output",
 CellChangeTimes->{{3.7903025887118206`*^9, 3.7903025988906393`*^9}, 
   3.790302765128997*^9, {3.790302810951497*^9, 3.790302863798129*^9}, 
   3.79030309470337*^9, 3.790304916188558*^9, 3.79030518754981*^9, 
   3.7903054384523067`*^9, 3.7903056886130047`*^9, 3.7909190262828445`*^9, 
   3.7909473835453587`*^9, 3.7909892742717304`*^9},
 CellLabel->
  "Out[2334]=",ExpressionUUID->"9561e1ff-21ec-4e24-a21f-95f9ff385d51"],

Cell[BoxData[
 RowBox[{"0.007333481481583732`", "\[VeryThinSpace]", "-", 
  RowBox[{"0.011049009725453897`", " ", "x"}], "+", 
  RowBox[{"0.00117825260825551`", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  RowBox[{"0.05778247741513532`", " ", "y"}], "-", 
  RowBox[{"0.009969977792619765`", " ", "x", " ", "y"}], "+", 
  RowBox[{"0.0013638872298448318`", " ", 
   SuperscriptBox["y", "2"]}]}]], "Output",
 CellChangeTimes->{{3.7903025887118206`*^9, 3.7903025988906393`*^9}, 
   3.790302765128997*^9, {3.790302810951497*^9, 3.790302863798129*^9}, 
   3.79030309470337*^9, 3.790304916188558*^9, 3.79030518754981*^9, 
   3.7903054384523067`*^9, 3.7903056886130047`*^9, 3.7909190262828445`*^9, 
   3.7909473835453587`*^9, 3.7909892742776775`*^9},
 CellLabel->
  "Out[2335]=",ExpressionUUID->"3c508367-7be0-40b9-bf07-ef74bf31f3b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"NSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"eq1Aprox", "\[Equal]", "0"}], " ", ",", " ", 
      RowBox[{"eq2Aprox", "\[Equal]", "0"}]}], " ", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", "Reals"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7903026462690315`*^9, 3.7903026684160304`*^9}, {
  3.790302712409527*^9, 3.7903027141267796`*^9}},
 CellLabel->
  "In[2336]:=",ExpressionUUID->"062ff9f3-65cb-44d7-81eb-3a3e92d82523"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "24.152136262259088`"}], ",", 
     RowBox[{"y", "\[Rule]", "2.379626670982999`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "3.4013622930128737`"}], ",", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{"-", "18.172582434287914`"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "6.45577382601854`"}], ",", 
     RowBox[{"y", "\[Rule]", "6.504081355820647`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "4.589945776413081`"}], ",", 
     RowBox[{"y", "\[Rule]", "1.340065201952824`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "5.031631528540805`"}], ",", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{"-", "7.408891180412533`"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "1.2399999999999878`"}], ",", 
     RowBox[{"y", "\[Rule]", "0.09999999999996022`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.790302639422695*^9, 3.7903026855127993`*^9}, 
   3.7903027651798625`*^9, 3.790302839366807*^9, 3.7903028732397304`*^9, 
   3.7903030947542353`*^9, 3.790304916243411*^9, 3.7903051876046643`*^9, 
   3.790305438512205*^9, 3.790305688672844*^9, 3.79091902853732*^9, 
   3.790947383596224*^9, 3.790989274330535*^9},
 CellLabel->
  "Out[2336]=",ExpressionUUID->"d7dfe697-d5ee-4578-9c11-6a24e2379137"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "/.", "\[VeryThinSpace]", "sol"}], "//", 
   "Transpose"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.790302710018759*^9, 3.7903027101564226`*^9}},
 CellLabel->
  "In[2337]:=",ExpressionUUID->"bed39a38-c111-40d6-a6d8-bd7fe904566b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"24.152136262259088`", "3.4013622930128737`", "6.45577382601854`", 
      "4.589945776413081`", "5.031631528540805`", "1.2399999999999878`"},
     {"2.379626670982999`", 
      RowBox[{"-", "18.172582434287914`"}], "6.504081355820647`", 
      "1.340065201952824`", 
      RowBox[{"-", "7.408891180412533`"}], "0.09999999999996022`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.790302701332076*^9, 3.790302765223798*^9, 
  3.790303094797121*^9, 3.790304916289291*^9, 3.7903051876505413`*^9, 
  3.790305438557027*^9, 3.7903056887326846`*^9, 3.7909190302358723`*^9, 
  3.790947383625146*^9, 3.7909892743644457`*^9},
 CellLabel->
  "Out[2337]//MatrixForm=",ExpressionUUID->"14bd168f-c84f-449a-98c6-\
8289a7dcd3cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "the", " ", "nullspace", " ", "by", " ", "cheching", " ", 
    "value", " ", "of", " ", "smallest", " ", "singular", " ", 
    RowBox[{"value", ".", " ", "The"}], " ", "null", " ", "space", " ", 
    "will", " ", "be", " ", "1", "D", " ", "only"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nsol", "=", 
     RowBox[{
      RowBox[{"Dimensions", "[", "sol", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphaAcc", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alpha", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", "nsol"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wts", "=", 
       RowBox[{"Mat4", "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "w", ",", "v"}], "}"}], "=", 
       RowBox[{"SingularValueDecomposition", "[", "wts", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Diagonal", "[", "w", "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "5"}], "]"}], "]"}], "<", 
         RowBox[{"10", "^", 
          RowBox[{"-", "5"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alphaAcc", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"alphaAcc", ",", 
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "5"}], "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Total Solutions found: \>\"", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", "alphaAcc", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"alpha", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"alpha", ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "5"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{"alpha", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Transpose", "[", "alphaAcc", "]"}], "//", 
    "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.7903031934222717`*^9, 3.790303231507584*^9}},
 CellLabel->
  "In[2338]:=",ExpressionUUID->"178c17c2-7091-41c7-8be6-f34a98b44842"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "16.82848966980103`", ",", "4.35762537195467`", ",", "1.0221739446080191`", 
   ",", "0.6640226991257149`", ",", "0.1136789400697804`"}], "}"}]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.790989274408328*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"4ee36205-ed26-4254-9ef2-d2e0c8cde325"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "12.943969349826206`", ",", "4.233095120222228`", ",", 
   "1.0177145253794404`", ",", "0.7201323813672371`", ",", 
   "0.1617543501220994`"}], "}"}]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.7909892744123187`*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"55a31414-32dc-410f-be44-c44b130d332a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6.367798981636231`", ",", "1.3725776211416496`", ",", 
   "0.9605478697968448`", ",", "0.603493202596461`", ",", "0.`"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.790989274419301*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"a68b377f-a634-4c88-b405-64ffd64a86d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total Solutions found: \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Total Solutions found: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.7909892744222937`*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"90bdca02-ef95-4488-965e-da5a631d7b8c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.1480397204230592`", ",", "1.0229982767690884`", ",", 
   "0.8006893101936343`", ",", "0.22553943773421278`", ",", "0.`"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.790989274424288*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"b281512f-afd8-4d77-a70c-d6ab410b199d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total Solutions found: \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Total Solutions found: ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.7909892744282737`*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"abbf5f73-8d7e-4d6b-9b97-dd3acc39367e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6.057070317567235`", ",", "2.0238661524110375`", ",", 
   "0.9941319836977326`", ",", "0.6725964219702247`", ",", "0.`"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.790989274430269*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"dae860c1-5076-4bc3-8c57-2eb4260094a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total Solutions found: \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Total Solutions found: ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.79098927443326*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"a3e3aa5c-300a-44ee-8b47-28edbf599bed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.175336117331391`", ",", "1.0024807269908191`", ",", 
   "0.7875766701592266`", ",", "0.39591779615441397`", ",", "0.`"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.7909892744362526`*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"fbfa71f8-67cf-482f-8620-c1bf1ffcfc88"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total Solutions found: \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["Total Solutions found: ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{3.7903031595325174`*^9, 3.790303197161484*^9, 
  3.7903032320650644`*^9, 3.790304916347133*^9, 3.790305187709382*^9, 
  3.7903054386118784`*^9, 3.790305688811985*^9, 3.7909190317689257`*^9, 
  3.7909473836600533`*^9, 3.790989274438258*^9},
 CellLabel->
  "During evaluation of \
In[2338]:=",ExpressionUUID->"0db2a58a-a373-45c7-9abe-098282c8c3a0"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.16268667638445722`"}], "0.042524013125773585`", 
      RowBox[{"-", "0.13740652122553074`"}], 
      RowBox[{"-", "0.15264324772790216`"}]},
     {"0.5818491486822707`", 
      RowBox[{"-", "0.7621012329219994`"}], 
      RowBox[{"-", "0.20475353384074207`"}], "0.12600612240497427`"},
     {"0.4457781687944251`", 
      RowBox[{"-", "0.17950442711068343`"}], 
      RowBox[{"-", "0.2174523561544885`"}], "0.8342794831697383`"},
     {"0.4949082888735975`", "0.5631309308872977`", 
      RowBox[{"-", "0.8194093342113845`"}], "0.3415910645812133`"},
     {"0.4374153899158019`", "0.2608737901977092`", 
      RowBox[{"-", "0.46955111980969994`"}], "0.38485813568099175`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7903031595594435`*^9, 3.7903031972113953`*^9, 
  3.790303232105957*^9, 3.790304916388028*^9, 3.790305187754263*^9, 
  3.790305438657756*^9, 3.7903056888698378`*^9, 3.7909190318108115`*^9, 
  3.7909473836949577`*^9, 3.7909892744422364`*^9},
 CellLabel->
  "Out[2343]//MatrixForm=",ExpressionUUID->"05b41ca4-c9fc-46f1-87cd-\
13df0c5c58d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Finding", " ", "dyad", " ", "parameters", " ", "by", " ", "multiplying", 
    " ", "weights", " ", "to", " ", "null", " ", "space", " ", "basis"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{"nullSp", ".", 
      RowBox[{"Transpose", "[", "alphaAcc", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"Chop", "[", "P", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7903032815798616`*^9, 3.790303287401002*^9}},
 CellLabel->
  "In[2344]:=",ExpressionUUID->"f4b67d76-c678-473f-8df7-69d0baf497be"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.845594070897475`", "0.3109427928198657`", 
      RowBox[{"-", "0.91488867956133`"}], "0.7833756613254073`"},
     {"0.3407589173742073`", 
      RowBox[{"-", "0.6538576086791751`"}], "0.18508842265020553`", 
      "0.4392136769555814`"},
     {
      RowBox[{"-", "0.031422466749556344`"}], 
      RowBox[{"-", "0.21605729678076802`"}], "0.11385636601696628`", 
      RowBox[{"-", "0.019964258043422833`"}]},
     {"0.15051553073710747`", 
      RowBox[{"-", "0.5685718336339574`"}], "0.0599036517000171`", 
      RowBox[{"-", "0.19964258043435712`"}]},
     {"0.34330876221079626`", 
      RowBox[{"-", "0.190898078344577`"}], 
      RowBox[{"-", "0.27253585132199265`"}], "0.03542045781898473`"},
     {
      RowBox[{"-", "0.031657596075626085`"}], 
      RowBox[{"-", "0.06307936501815621`"}], 
      RowBox[{"-", "0.16764928457738576`"}], 
      RowBox[{"-", "0.001610020809953934`"}]},
     {"0.15164181453866846`", 
      RowBox[{"-", "0.16599832899523848`"}], 
      RowBox[{"-", "0.08820590980030504`"}], 
      RowBox[{"-", "0.016100208099537813`"}]},
     {"0.05278358978452149`", 
      RowBox[{"-", "0.1424543209288515`"}], "0.03678497155451835`", 
      "0.3542045781899892`"},
     {
      RowBox[{"-", "0.004867343187103383`"}], 
      RowBox[{"-", "0.047071862567756535`"}], "0.022628120793652305`", 
      RowBox[{"-", "0.016100208099534708`"}]},
     {"0.02331487050096007`", 
      RowBox[{"-", "0.12387332254680247`"}], "0.01190541305742105`", 
      RowBox[{"-", "0.16100208099545182`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7903032880412493`*^9, 3.790304916435207*^9, 
  3.7903051878001404`*^9, 3.790305438704636*^9, 3.790305688922482*^9, 
  3.790919034469246*^9, 3.790947383729873*^9, 3.7909892744851227`*^9},
 CellLabel->
  "Out[2345]//MatrixForm=",ExpressionUUID->"721f08df-28f7-49aa-bf2a-\
94771dd63612"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Mechanism Parameters", "Subchapter",
 CellChangeTimes->{{3.7737993047391186`*^9, 
  3.773799327207224*^9}},ExpressionUUID->"f27812ed-1c67-4c72-81d5-\
54807fa4efc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"FP", " ", "coord", " ", "in", " ", "fixed", " ", "frame"}], ",", 
    " ", 
    RowBox[{"MP", " ", "coord", " ", "in", " ", "moving", " ", "frame"}], ",",
     " ", 
    RowBox[{"Link", " ", "Length"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ndyads", "=", 
     RowBox[{
      RowBox[{"Dimensions", "[", "P", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FPs", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MPmfs", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lens", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", "ndyads"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FPs", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"FPs", ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i"}], "]"}], "]"}], 
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "i"}], "]"}], "]"}]], ",", 
           FractionBox[
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i"}], "]"}], "]"}], 
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "i"}], "]"}], "]"}]], ",", "1"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MPmfs", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"MPmfs", ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i"}], "]"}], "]"}], 
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"8", ",", "i"}], "]"}], "]"}]], ",", 
           FractionBox[
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"5", ",", "i"}], "]"}], "]"}], 
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"8", ",", "i"}], "]"}], "]"}]], ",", "1"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lens", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"Lens", ",", 
         RowBox[{"{", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i"}], "]"}], "]"}], 
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"4", ",", "i"}], "]"}], "]"}]], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "i"}], "]"}], "]"}], 
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"4", ",", "i"}], "]"}], "]"}]], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i"}], "]"}], "]"}], 
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"8", ",", "i"}], "]"}], "]"}]], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"5", ",", "i"}], "]"}], "]"}], 
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"8", ",", "i"}], "]"}], "]"}]], ")"}], "2"], "+", 
            FractionBox[
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"10", ",", "i"}], "]"}], "]"}]]}], "]"}], "}"}]}], 
        "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputData", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"FPs", ",", "MPmfs", ",", "2"}], "]"}], ",", "Lens", ",", 
       "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputData", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"outputData", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "<", 
        RowBox[{"#2", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}], "&"}]}], "]"}], "//", 
    "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.7737995871905756`*^9, 3.773799589269003*^9}, {
   3.773799644747681*^9, 3.773799652016286*^9}, {3.773799870605768*^9, 
   3.773799907111063*^9}, {3.77380005453328*^9, 3.773800107295885*^9}, {
   3.773800308772416*^9, 3.7738003875455804`*^9}, {3.7738004363862095`*^9, 
   3.773800498466628*^9}, {3.7738005636620135`*^9, 3.7738006186719103`*^9}, {
   3.773803716681394*^9, 3.7738038025884733`*^9}, {3.7738039944438915`*^9, 
   3.773804088665313*^9}, {3.7738394263560023`*^9, 3.7738394928726892`*^9}, {
   3.773839523084121*^9, 3.7738396434736176`*^9}, {3.7738404646454964`*^9, 
   3.773840475319296*^9}, {3.7738519468662577`*^9, 3.7738520158056345`*^9}, {
   3.7738520499253983`*^9, 3.773852289706395*^9}, {3.7738523935844727`*^9, 
   3.7738523936612635`*^9}, 3.773852452452868*^9, {3.7738524912275457`*^9, 
   3.7738525309532146`*^9}, {3.773852734727481*^9, 3.773852761748603*^9}, {
   3.773852799066203*^9, 3.7738528176995153`*^9}, {3.7738529130595403`*^9, 
   3.773852925620906*^9}, {3.773853062601889*^9, 3.7738530629308853`*^9}, {
   3.773853565833151*^9, 3.7738536016423244`*^9}, {3.781495245502265*^9, 
   3.78149526329478*^9}, {3.7814955077001514`*^9, 3.781495580646161*^9}, {
   3.781495658404913*^9, 3.781495707092942*^9}, {3.781495881146819*^9, 
   3.781495906955021*^9}, {3.7814964813483458`*^9, 3.7814965094194937`*^9}, {
   3.7814965475230837`*^9, 3.781496764946216*^9}, {3.781498094735652*^9, 
   3.7814981503697004`*^9}, {3.781498434013868*^9, 3.7814984977688007`*^9}, {
   3.781498544637433*^9, 3.7814985456453934`*^9}, {3.781498899260044*^9, 
   3.7814990045551043`*^9}, 3.781501012710064*^9, {3.7815010738915815`*^9, 
   3.7815010857228065`*^9}, {3.781501414413432*^9, 3.7815014146876974`*^9}, {
   3.7818295103717575`*^9, 3.7818295191408634`*^9}, {3.781829554966564*^9, 
   3.781829569078639*^9}, {3.781829647307225*^9, 3.7818296534987507`*^9}, 
   3.7818296954310083`*^9, {3.7818298133952775`*^9, 3.7818298162832546`*^9}, 
   3.7818299641099596`*^9, {3.781830324950343*^9, 3.7818303326646166`*^9}, {
   3.7818786860334435`*^9, 3.7818787568238688`*^9}, {3.7818788399776154`*^9, 
   3.781878850055917*^9}, {3.781878886938572*^9, 3.781878891247506*^9}, {
   3.7818789251479425`*^9, 3.781878941610899*^9}, 3.781878991901975*^9, 
   3.781881514775242*^9, {3.790303858238163*^9, 3.7903038734914494`*^9}, {
   3.790303912692479*^9, 3.7903039474937186`*^9}, {3.790304846181114*^9, 
   3.7903048962845693`*^9}, {3.790304937696823*^9, 3.790304941556918*^9}, {
   3.7903050384718227`*^9, 3.79030506101572*^9}},
 CellLabel->
  "In[2346]:=",ExpressionUUID->"97a03a85-e149-48ac-ae1f-126c34c918f3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "2.1999999999999784`"}], "0.09999999999993549`", "1", 
      "1.2399999999999853`", "0.09999999999995995`", "1", 
      "1.2377300000000324`"},
     {"3.089768610052076`", "1.9006581867017258`", "1", "5.031631528541195`", 
      RowBox[{"-", "7.408891180412417`"}], "1", "4.0646906575856745`"},
     {"1.1500000000002184`", "0.3799999999997612`", "1", "4.589945776413078`",
       "1.3400652019528465`", "1", "4.671200000000758`"},
     {"2.2639452268177003`", 
      RowBox[{"-", "0.20876561106799843`"}], "1", "6.455773826018425`", 
      "6.50408135582074`", "1", "11.198998386670144`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7814967052258625`*^9, 3.781496765382105*^9}, {
   3.781498122784929*^9, 3.7814981509650755`*^9}, 3.7814984358549843`*^9, {
   3.781498505385895*^9, 3.7814985540175304`*^9}, {3.7814989119745145`*^9, 
   3.7814990060430884`*^9}, 3.781501086654316*^9, 3.7815014158884864`*^9, 
   3.7815050354358587`*^9, 3.7815053202589445`*^9, 3.781505878068115*^9, 
   3.7815060698064322`*^9, 3.7816137378159075`*^9, 3.7818283268103676`*^9, 
   3.7818291861010056`*^9, 3.7818295199002132`*^9, {3.7818295625970526`*^9, 
   3.781829569572316*^9}, 3.7818296550972977`*^9, 3.781829817488567*^9, 
   3.781829970090494*^9, 3.7818303336237025`*^9, 3.7818769511110168`*^9, 
   3.7818773854955053`*^9, 3.781877508567897*^9, 3.7818782202469234`*^9, 
   3.7818787578090663`*^9, 3.7818788508193846`*^9, 3.781878944505129*^9, 
   3.7818789926306863`*^9, 3.781880814395121*^9, {3.781881515457059*^9, 
   3.781881530332664*^9}, 3.7818822841264734`*^9, 3.7818823834667506`*^9, 
   3.7818849266188364`*^9, 3.7818870348319473`*^9, 3.7818873221097283`*^9, 
   3.781887560299343*^9, 3.78188875949454*^9, 3.7818889241272335`*^9, 
   3.781890344925137*^9, 3.7818928805732718`*^9, 3.7818952346677036`*^9, 
   3.781895308715799*^9, 3.781962913368264*^9, {3.782083012869693*^9, 
   3.782083054187537*^9}, {3.782083166695754*^9, 3.782083193389429*^9}, 
   3.782083595519456*^9, {3.7820836308387346`*^9, 3.7820836505305805`*^9}, 
   3.7820837360217814`*^9, 3.78225955559431*^9, 3.78232778068886*^9, 
   3.7823280788871555`*^9, {3.790304898934827*^9, 3.7903049436275387`*^9}, 
   3.7903050633136387`*^9, 3.7903051878530016`*^9, 3.7903054387505083`*^9, 
   3.790305688981324*^9, 3.7909190397870197`*^9, 3.790947383767762*^9, 
   3.7909892745329947`*^9},
 CellLabel->
  "Out[2353]//MatrixForm=",ExpressionUUID->"391483ee-1d44-4f97-8ec7-\
57322c7283a8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing the correctness of results", "Subchapter",
 CellChangeTimes->{{3.7818815536207943`*^9, 
  3.781881570576661*^9}},ExpressionUUID->"c5aa17f7-fbb3-4b95-afbb-\
5c5b9fd2f7e0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dimensions", "[", "P", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "K", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K", ".", "P"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7818822069448643`*^9, 3.7818822338198104`*^9}, {
  3.781882420091072*^9, 3.7818824358890295`*^9}},
 CellLabel->
  "In[2354]:=",ExpressionUUID->"f89dde96-0b15-4bdb-8473-43e9d230755f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.7903051580426564`*^9, 3.7903051878998737`*^9}, 
   3.790305438796386*^9, 3.790305689028263*^9, 3.79091906032073*^9, 
   3.7909473838026695`*^9, 3.790989274572888*^9},
 CellLabel->
  "Out[2354]=",ExpressionUUID->"0b34c220-d8bd-42e5-96f5-4084a1aefce0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{{3.7903051580426564`*^9, 3.7903051878998737`*^9}, 
   3.790305438796386*^9, 3.790305689028263*^9, 3.79091906032073*^9, 
   3.7909473838026695`*^9, 3.790989274579876*^9},
 CellLabel->
  "Out[2355]=",ExpressionUUID->"4c7513b7-a496-4f87-9561-76fe0d7dae6a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "8.326672684688674`*^-16"}], 
      RowBox[{"-", "1.3877787807814457`*^-16"}], "1.124100812432971`*^-15", 
      RowBox[{"-", "1.0547118733938987`*^-15"}]},
     {"1.3183898417423734`*^-15", "6.106226635438361`*^-16", 
      RowBox[{"-", "1.0130785099704553`*^-15"}], "8.881784197001252`*^-16"},
     {"5.273559366969494`*^-16", "8.881784197001252`*^-16", 
      RowBox[{"-", "2.7755575615628914`*^-16"}], 
      RowBox[{"-", "2.220446049250313`*^-16"}]},
     {"2.4424906541753444`*^-15", 
      RowBox[{"-", "4.440892098500626`*^-16"}], 
      RowBox[{"-", "1.1102230246251565`*^-15"}], "1.7763568394002505`*^-15"},
     {"9.43689570931383`*^-16", 
      RowBox[{"-", "8.881784197001252`*^-16"}], "4.718447854656915`*^-16", 
      "4.440892098500626`*^-16"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7903051580426564`*^9, 3.7903051878998737`*^9}, 
   3.790305438796386*^9, 3.790305689028263*^9, 3.79091906032073*^9, 
   3.7909473838026695`*^9, 3.7909892745858517`*^9},
 CellLabel->
  "Out[2356]//MatrixForm=",ExpressionUUID->"9f5886e1-3b80-491e-a91e-\
2800454aa39e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1368, 869},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 236, 4, 48, "Input",ExpressionUUID->"17c693b0-862d-4520-bc11-871be0d058cd"],
Cell[CellGroupData[{
Cell[819, 28, 175, 3, 64, "Subchapter",ExpressionUUID->"f7a06c17-5781-4435-99e6-8dd526588c03"],
Cell[CellGroupData[{
Cell[1019, 35, 6221, 154, 409, "Input",ExpressionUUID->"5e095b90-bb69-4c62-8c36-04829b885541"],
Cell[7243, 191, 2499, 60, 198, "Output",ExpressionUUID->"13ea1aae-6fee-4e41-937c-70337437041a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9791, 257, 179, 3, 64, "Subchapter",ExpressionUUID->"bdb9bd4a-c093-4476-b158-37adc136f97e"],
Cell[CellGroupData[{
Cell[9995, 264, 3209, 94, 339, "Input",ExpressionUUID->"2d539f0e-749b-4232-8605-cb25bb7588d5"],
Cell[13207, 360, 2666, 57, 113, "Output",ExpressionUUID->"6ff1b49a-116e-4152-b16e-3460ae436339"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15922, 423, 198, 3, 64, "Subchapter",ExpressionUUID->"65adfd92-183e-471f-b240-e82d34234495"],
Cell[CellGroupData[{
Cell[16145, 430, 861, 21, 105, "Input",ExpressionUUID->"2cea9c1c-8145-4d81-a8c9-015763365fc8"],
Cell[17009, 453, 716, 13, 32, "Output",ExpressionUUID->"6f07aa06-25c0-4326-8a28-d5395d8147d4"],
Cell[17728, 468, 2822, 59, 198, "Output",ExpressionUUID->"2eea2a75-442c-4543-b5f6-6f452cd5878f"],
Cell[20553, 529, 2051, 46, 70, "Output",ExpressionUUID->"dd55bb68-6871-4a96-8a7c-a423485ae887"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22653, 581, 227, 3, 70, "Subchapter",ExpressionUUID->"cecb9402-f3ee-4a61-a394-088a6ce62a8e"],
Cell[CellGroupData[{
Cell[22905, 588, 1978, 56, 70, "Input",ExpressionUUID->"b4053bd2-d9b7-483b-83a5-1a9a0965a6b8"],
Cell[24886, 646, 4634, 102, 70, "Output",ExpressionUUID->"336d19a8-2bca-4282-a570-3005e51dc4f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29557, 753, 803, 21, 70, "Input",ExpressionUUID->"f28ad428-ca3e-4f4f-9ff1-92cd410055e9"],
Cell[30363, 776, 989, 19, 70, "Output",ExpressionUUID->"9561e1ff-21ec-4e24-a21f-95f9ff385d51"],
Cell[31355, 797, 826, 15, 70, "Output",ExpressionUUID->"3c508367-7be0-40b9-bf07-ef74bf31f3b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32218, 817, 526, 13, 70, "Input",ExpressionUUID->"062ff9f3-65cb-44d7-81eb-3a3e92d82523"],
Cell[32747, 832, 1464, 36, 70, "Output",ExpressionUUID->"d7dfe697-d5ee-4578-9c11-6a24e2379137"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34248, 873, 345, 9, 70, "Input",ExpressionUUID->"bed39a38-c111-40d6-a6d8-bd7fe904566b"],
Cell[34596, 884, 1247, 28, 70, "Output",ExpressionUUID->"14bd168f-c84f-449a-98c6-8289a7dcd3cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35880, 917, 2809, 73, 70, "Input",ExpressionUUID->"178c17c2-7091-41c7-8be6-f34a98b44842"],
Cell[CellGroupData[{
Cell[38714, 994, 562, 11, 70, "Print",ExpressionUUID->"4ee36205-ed26-4254-9ef2-d2e0c8cde325"],
Cell[39279, 1007, 570, 12, 70, "Print",ExpressionUUID->"55a31414-32dc-410f-be44-c44b130d332a"],
Cell[39852, 1021, 550, 12, 70, "Print",ExpressionUUID->"a68b377f-a634-4c88-b405-64ffd64a86d1"],
Cell[40405, 1035, 550, 11, 70, "Print",ExpressionUUID->"90bdca02-ef95-4488-965e-da5a631d7b8c"],
Cell[40958, 1048, 553, 12, 70, "Print",ExpressionUUID->"b281512f-afd8-4d77-a70c-d6ab410b199d"],
Cell[41514, 1062, 550, 11, 70, "Print",ExpressionUUID->"abbf5f73-8d7e-4d6b-9b97-dd3acc39367e"],
Cell[42067, 1075, 551, 12, 70, "Print",ExpressionUUID->"dae860c1-5076-4bc3-8c57-2eb4260094a9"],
Cell[42621, 1089, 547, 11, 70, "Print",ExpressionUUID->"a3e3aa5c-300a-44ee-8b47-28edbf599bed"],
Cell[43171, 1102, 554, 12, 70, "Print",ExpressionUUID->"fbfa71f8-67cf-482f-8620-c1bf1ffcfc88"],
Cell[43728, 1116, 548, 11, 70, "Print",ExpressionUUID->"0db2a58a-a373-45c7-9abe-098282c8c3a0"]
}, Open  ]],
Cell[44291, 1130, 1613, 36, 70, "Output",ExpressionUUID->"05b41ca4-c9fc-46f1-87cd-13df0c5c58d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45941, 1171, 646, 17, 70, "Input",ExpressionUUID->"f4b67d76-c678-473f-8df7-69d0baf497be"],
Cell[46590, 1190, 2378, 55, 70, "Output",ExpressionUUID->"721f08df-28f7-49aa-bf2a-94771dd63612"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49017, 1251, 180, 3, 70, "Subchapter",ExpressionUUID->"f27812ed-1c67-4c72-81d5-54807fa4efc6"],
Cell[CellGroupData[{
Cell[49222, 1258, 7519, 174, 70, "Input",ExpressionUUID->"97a03a85-e149-48ac-ae1f-126c34c918f3"],
Cell[56744, 1434, 2995, 53, 70, "Output",ExpressionUUID->"391483ee-1d44-4f97-8ec7-57322c7283a8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59788, 1493, 184, 3, 70, "Subchapter",ExpressionUUID->"c5aa17f7-fbb3-4b95-afbb-5c5b9fd2f7e0"],
Cell[CellGroupData[{
Cell[59997, 1500, 417, 8, 70, "Input",ExpressionUUID->"f89dde96-0b15-4bdb-8473-43e9d230755f"],
Cell[60417, 1510, 347, 7, 70, "Output",ExpressionUUID->"0b34c220-d8bd-42e5-96f5-4084a1aefce0"],
Cell[60767, 1519, 347, 7, 70, "Output",ExpressionUUID->"4c7513b7-a496-4f87-9561-76fe0d7dae6a"],
Cell[61117, 1528, 1627, 36, 70, "Output",ExpressionUUID->"9f5886e1-3b80-491e-a91e-2800454aa39e"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

